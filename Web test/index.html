<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Thu th·∫≠p d·ªØ li·ªáu</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #f4fbff;
    }
    img {
      width: 320px;
      border: 3px solid #4caf50;
      border-radius: 10px;
    }
    .choices {
      display: flex;
      gap: 18px;
      justify-content: center;
      align-items: flex-start;
      flex-wrap: wrap;
      margin-top: 10px;
    }
    .choice {
      background: #ffffff;
      padding: 12px 16px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.06);
      min-width: 220px;
    }
    .result-table {
      border-collapse: collapse;
      margin: 12px auto;
      min-width: 520px;
    }
    .result-table th, .result-table td {
      border: 1px solid #d0d7de;
      padding: 8px 10px;
      text-align: center;
    }
    .result-table img { width: 100px; height: auto; display: block; margin: 0 auto; }
    button {
      font-size: 22px;
      padding: 10px 20px;
      margin: 5px;
    }
    .box {
      margin-top: 20px;
      font-size: 24px;
    }
  </style>
</head>
<body>

<h1>üëÄ Quan s√°t b·ª©c ·∫£nh</h1>

<div id="qinfo" style="font-size:20px;margin-bottom:8px">C√¢u 1 / 5</div>
<img id="photo" src="./Image/Image1.png" alt="C√¥n tr√πng">

<p id="prompt"><b>Em h√£y ƒë·∫øm s·ªë con ong üêù trong b·ª©c ·∫£nh</b></p>

<!-- C√°c l·ª±a ch·ªçn (x·∫øp ngang) -->
<div class="choices">
  <div class="choice">
    <h2>üî¢ Ghi b·∫±ng s·ªë</h2>
    <button id="addNumberBtn" onclick="addNumber()">‚ûï</button>
    <button id="removeNumberBtn" onclick="removeNumber()">‚ûñ</button>
    <div class="box">S·ªë con ong: <span id="number">0</span></div>
  </div>

  <div class="choice">
    <h2>‚úçÔ∏è Ghi b·∫±ng v·∫°ch ki·ªÉm</h2>
    <button id="addTallyBtn" onclick="addTally()">Th√™m v·∫°ch |</button>
    <button id="removeTallyBtn" onclick="removeTally()">Xo√° v·∫°ch</button>
    <div class="box" id="tally"></div>
  </div>

  <div class="choice">
    <h2>‚≠ê Ghi b·∫±ng k√Ω hi·ªáu</h2>
    <button id="addIconBtn" onclick="addIcon()">üêù</button>
    <button id="removeIconBtn" onclick="removeIcon()">Xo√° con ong</button>
    <div class="box" id="icons"></div>
  </div>
</div>

<hr>

<div style="margin-top:12px">
  <button id="answerBtn" onclick="submitAnswer()" disabled>Tr·∫£ l·ªùi</button>
</div>

<h2 id="result"></h2>

<script>
let number = 0;
let tally = "";
let icons = "";
let selectedMethod = null; // 'number' | 'tally' | 'icons' or null
const questions = [
  {img: './Image/Image1.png', prompt: 'Em h√£y ƒë·∫øm s·ªë con ong üêù trong b·ª©c ·∫£nh 1'},
  {img: './Image/Image2.png', prompt: 'Em h√£y ƒë·∫øm s·ªë con ong üêù trong b·ª©c ·∫£nh 2'},
  {img: './Image/Image3.png', prompt: 'Em h√£y ƒë·∫øm s·ªë con ong üêù trong b·ª©c ·∫£nh 3'},
  {img: './Image/Image4.png', prompt: 'Em h√£y ƒë·∫øm s·ªë con ong üêù trong b·ª©c ·∫£nh 4'},
  {img: './Image/Image5.png', prompt: 'Em h√£y ƒë·∫øm s·ªë con ong üêù trong b·ª©c ·∫£nh 5'}
];
let currentQ = 0;
const answers = [];

function loadQuestion(idx = 0) {
  currentQ = idx;
  const q = questions[currentQ];
  document.getElementById('photo').src = q.img;
  document.getElementById('prompt').innerText = q.prompt;
  document.getElementById('qinfo').innerText = `C√¢u ${currentQ+1} / ${questions.length}`;
  // reset counters
  number = 0; tally = ''; icons = '';
  selectedMethod = null;
  update();
  document.getElementById('answerBtn').disabled = true;
}

function submitAnswer() {
  // store a simple snapshot of counts
  answers.push({
    number: number,
    tally: tally.length,
    icons: (icons.match(/üêù/g) || []).length,
  });
  // move to next question or finish
  if (currentQ < questions.length - 1) {
    loadQuestion(currentQ + 1);
  } else {
    // finished - show summary as a table
    const res = document.getElementById('result');
    res.innerHTML = `<div>üéâ Ho√†n th√†nh! B·∫°n ƒë√£ tr·∫£ l·ªùi ${answers.length} c√¢u.</div>`;
    let html = '<table class="result-table"><thead><tr><th>C√¢u</th><th>·∫¢nh</th><th>S·ªë</th><th>V·∫°ch</th><th>Bi·ªÉu t∆∞·ª£ng</th></tr></thead><tbody>';
    answers.forEach((a, i) => {
      const q = questions[i];
      html += `<tr>` +
              `<td>${i+1}</td>` +
              `<td><img src="${q.img}" alt="img${i+1}"></td>` +
              `<td>${a.number}</td>` +
              `<td>${a.tally}</td>` +
              `<td>${a.icons}</td>` +
              `</tr>`;
    });
    html += '</tbody></table>';
    res.innerHTML += html;
    // disable controls
    document.getElementById('answerBtn').disabled = true;
  }
}

function addNumber() {
  if (!selectedMethod) selectedMethod = 'number';
  number++;
  update();
}
function removeNumber() {
  if (number > 0) number--;
  // if number becomes zero and it was the selected method, clear selection
  if (number === 0 && selectedMethod === 'number') selectedMethod = null;
  update();
}
function addTally() {
  if (!selectedMethod) selectedMethod = 'tally';
  tally += "|";
  update();
}
function addIcon() {
  if (!selectedMethod) selectedMethod = 'icons';
  icons += "üêù ";
  update();
}

function removeTally() {
  if (tally.length > 0) {
    tally = tally.slice(0, -1);
    if (tally.length === 0 && selectedMethod === 'tally') selectedMethod = null;
    update();
  }
}

function removeIcon() {
  const idx = icons.lastIndexOf('üêù');
  if (idx !== -1) {
    icons = icons.slice(0, idx).trim();
    if (((icons.match(/üêù/g) || []).length) === 0 && selectedMethod === 'icons') selectedMethod = null;
    update();
  }
}

function update() {
  document.getElementById("number").innerText = number;
  document.getElementById("tally").innerText = tally;
  document.getElementById("icons").innerText = icons;
  document.getElementById("result").innerText =
    "‚úÖ Con ƒë√£ thu th·∫≠p d·ªØ li·ªáu v·ªÅ s·ªë con ong";
  // enable 'Tr·∫£ l·ªùi' button only after student has entered a count
  const ready = number > 0 || tally.length > 0 || icons.length > 0;
  const btn = document.getElementById('answerBtn');
  if (btn) btn.disabled = !ready;

  // lock other methods if one selected
  updateMethodLock();
}

function updateMethodLock() {
  const addNumberBtn = document.getElementById('addNumberBtn');
  const removeNumberBtn = document.getElementById('removeNumberBtn');
  const addTallyBtn = document.getElementById('addTallyBtn');
  const removeTallyBtn = document.getElementById('removeTallyBtn');
  const addIconBtn = document.getElementById('addIconBtn');
  const removeIconBtn = document.getElementById('removeIconBtn');
  if (!addNumberBtn) return;
  if (!selectedMethod) {
    addNumberBtn.disabled = false; removeNumberBtn.disabled = false;
    addTallyBtn.disabled = false; removeTallyBtn.disabled = false;
    addIconBtn.disabled = false; removeIconBtn.disabled = false;
  } else if (selectedMethod === 'number') {
    addNumberBtn.disabled = false; removeNumberBtn.disabled = false;
    addTallyBtn.disabled = true; removeTallyBtn.disabled = true;
    addIconBtn.disabled = true; removeIconBtn.disabled = true;
  } else if (selectedMethod === 'tally') {
    addNumberBtn.disabled = true; removeNumberBtn.disabled = true;
    addTallyBtn.disabled = false; removeTallyBtn.disabled = false;
    addIconBtn.disabled = true; removeIconBtn.disabled = true;
  } else if (selectedMethod === 'icons') {
    addNumberBtn.disabled = true; removeNumberBtn.disabled = true;
    addTallyBtn.disabled = true; removeTallyBtn.disabled = true;
    addIconBtn.disabled = false; removeIconBtn.disabled = false;
  }
}

// initialize first question on load
loadQuestion(0);
</script>

</body>
</html>
